---
title: "Incarceration Report"
author: "Hyewon Sim"
data: "2/25/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Summary

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Trends over time

This graph was created to look at population trends for each race from 1987 to 2018.
-Red: Asian American
- Blue: White
-Yellow: Black
-Green: Latin
Latinos and Asian Americans make up very little of this graph. Since 2000, the black jail population has been decreasing while the white jail population has been increasing.


```{r plot_line, echo=FALSE}
incarceration <- read.csv("https://raw.githubusercontent.com/vera-institute/incarceration-trends/master/incarceration_trends.csv")

library(dplyr)
library(ggplot2)

df <- incarceration %>%
  select(yfips, year, state, total_pop, urbanicity, total_jail_pop, aapi_jail_pop, black_jail_pop, latinx_jail_pop, white_jail_pop) 

df2 <- incarceration %>%
  filter(year >=1987) %>%
  select(year,total_jail_pop, aapi_jail_pop,black_jail_pop, white_jail_pop,latinx_jail_pop) %>%
  group_by(year) %>%
  summarise(
    black_jail_sum =sum(black_jail_pop, na.rm =TRUE),
    white_jail_sum =sum(white_jail_pop, na.rm =TRUE),
    aapi_jail_sum =sum(aapi_jail_pop, na.rm =TRUE),
    latinx_jail_sum= sum(latinx_jail_pop, na.rm =TRUE)
  )


ggplot(df2, aes(x=year)) + 
  geom_line(aes(y = aapi_jail_sum), color = "red") + 
  geom_line(aes(y = white_jail_sum), color="blue") +
  geom_line(aes(y= black_jail_sum), color="yellow") +
  geom_line(aes(y= latinx_jail_sum), color="green")+
  scale_y_continuous(labels = scales::comma) +
  ggtitle("Population for each race from 1987-2018")+
  xlab("Year") +
  ylab("Race") 
```

## black jail population vs White jail population

This graph was created to examine the relationship between the white prison population and the black prison population in 2018. If you look at the graph, you can see that the graph is increasing positively. In other words, if the population of white prisons increases, so will the population of black prisons. This means that we cannot see racism when they are incarcerated.


```{r plot_scatter, echo=FALSE}
df <- df %>%
  group_by(year) %>%
  filter(year == 2018) %>%
  mutate(white_trend_2018 = white_jail_pop)
df <- df %>%
  group_by(year) %>%
  filter(year == 2018) %>%
  mutate(black_trend_2018 = black_jail_pop)


ggplot(df, aes(x=white_trend_2018, y=black_trend_2018)) +
  geom_point () +
  geom_smooth(method = lm, formula = y ~ splines::bs(x, 3), se = FALSE) +
  labs(title = "White pop vs Black pop in 2018",
       x = "White jail population in 2018",
       y ="Black jail population  in 2018")

```
## black jail population map

You can also embed plots, for example:

```{r plot_map, echo=FALSE}
library("tidyverse")
library("maps")
library("mapproj")
library("usdata")
library("patchwork")

incarceration <- na.omit(incarceration)  

white_jail <-incarceration %>%
  filter(year >= "1990", na.rm = TRUE) %>%
  select(white_jail_pop, fips)


county_shape <- map_data("county") %>%
  unite(polyname, region, subregion, sep = ",",na.rm = TRUE) %>%
  left_join(county.fips, by="polyname", na.rm=TRUE)



map_data <- county_shape %>%
  left_join(white_jail, by="fips", na.rm = TRUE) 


blank_theme <- theme_bw() +
  theme(
    axis.line = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    axis.title = element_blank(),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()
  )

ggplot(map_data) +
  geom_polygon(aes(x=long, y= lat, group= group, fill = white_jail_pop),
               color = "black",
               size = 0.3
  ) +
  scale_fill_continuous(limits = c(0, max(map_data$white_jail_pop)), na.value = "gray", low = "yellow", high ="red") +
  coord_map() +
  labs(fill = "population") +
  blank_theme +
  ggtitle("Black Jail Population since 1990")




```
